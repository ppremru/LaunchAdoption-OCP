# Step 1: Bastion Preparation (Connected)

Created Date: January 14, 2026

Status: Initial Setup

This document provides a checklist for preparing the internet-facing (Connected) bastion host. Completion of these tasks is required to establish the secure supply chain before container images can be mirrored to physical media.

## Connectivity & Credentials Overview

| Task | Description |
| --- | --- |
| Red Hat Pull Secret | Log in to the [Red Hat Hybrid Cloud Console](https://www.google.com/search?q=https://console.redhat.com/openshift/install/pull-secret) and download your unique pull secret. This JSON file allows authentication to Red Hat and Quay registries. Administrators typically store this output in a file named **pull-secret.txt**. |
| Internet Access | Ensure the host can reach required endpoints on port 443 for image and binary acquisition. These sites include **registry.redhat.io** and **quay.io**. |
| Subscription | Ensure the RHEL host is registered and has an active OpenShift subscription attached to access the necessary repositories. |

### Connectivity & Credentials Reference Script

> **Note**: The following commands are provided as a **functional guide**. Administrators should adapt these to their specific organizational security policies and network configurations.

```bash
# 1. Verification of Red Hat Pull Secret
# Ensure the pull-secret.txt exists in your current directory
ls -l ./pull-secret.txt

# 2. Internet Connectivity Check
# Verify host can reach registry.redhat.io and quay.io via port 443
curl -v https://registry.redhat.io
curl -v https://quay.io

# 3. Subscription Management
# Register the system and attach a valid OpenShift subscription
sudo subscription-manager register
sudo subscription-manager attach --pool=<your_pool_id>
sudo subscription-manager status

```

---

## Binary Acquisition (Version 4.16)

| Binary | Purpose | Acquisition Link |
| --- | --- | --- |
| OpenShift CLI (oc) | The primary command-line tool for managing OpenShift clusters. | [Download oc 4.16](https://www.google.com/search?q=https://mirror.openshift.com/pub/openshift-v4/clients/ocp/latest-4.16/openshift-client-linux.tar.gz) |
| oc-mirror (v2) | The plugin required for declarative mirroring in disconnected environments. | [Download oc-mirror v2](https://www.google.com/search?q=https://mirror.openshift.com/pub/openshift-v4/clients/ocp/latest-4.16/oc-mirror.tar.gz) |
| Agent Installer | The binary used to generate the bootable Agent ISO for SNO. | [Download Installer](https://www.google.com/search?q=https://mirror.openshift.com/pub/openshift-v4/clients/ocp/latest-4.16/openshift-install-linux.tar.gz) |

---

## System Configuration & Security Overview

| Category | Justification |
| --- | --- |
| **1. User Permissions** | Prevents permission issues by ensuring configuration files generated by the installer are readable by the system. |
| **2. Path Setup** | Ensures tools are globally executable and sets the required 755 execution permissions in a single atomic step. |
| **3. fapolicyd whitelisting** | Necessary for environments running hardened profiles where application whitelisting (fapolicyd) would otherwise block the `oc` binary. |

### Bastion Setup Reference Script

> **Note**: This script represents a **baseline implementation**. Modifications may be required based on your specific system hardening requirements.

```bash
# 1. User Permissions
# Set umask to ensure installer-generated files are readable
umask 0022

# 2. Path Setup
# Extract all downloaded OpenShift tarballs
ls *.tar.gz | xargs -n1 tar -xvf

# Install binaries to system path with 755 permissions
sudo install -m 0755 oc oc-mirror openshift-install /usr/local/bin/

# 3. fapolicyd whitelisting (If applicable for hardened profiles)
# Add binary to trust list and update policy
sudo fapolicyd-cli --add /usr/local/bin/oc
sudo fapolicyd-cli --update

```

---

## Architectural Justifications & Reference Notes

| Category | Technical Requirement Details | Documentation Source |
| --- | --- | --- |
| **OC-Mirror v2** | Administrators must use the v2 binary for 4.16. It is a complete rewrite designed for better performance and reliability during large-scale platform mirroring. | [oc-mirror Documentation](https://docs.redhat.com/en/documentation/openshift_container_platform/4.16/html/disconnected_installation_mirroring/installing-mirroring-disconnected) |
| **Disk Space** | This bastion requires at least **200GB** of available storage on the partition where mirroring occurs to prevent disk-fill outages during image downloads. | [Mirroring images for disconnected installation](https://docs.redhat.com/en/documentation/openshift_container_platform/4.16/html/disconnected_installation_mirroring/index) |
| **FIPS Mode** | If the solution requires FIPS compliance, ensure the bastion OS is in FIPS mode before running mirroring operations to ensure cryptographic integrity. | [SNO Preparing to Install](https://www.google.com/search?q=https://docs.redhat.com/en/documentation/openshift_container_platform/4.16/html/installing_on_a_single_node/installing-sno-preparing-to-install-on-a-single-node) |

---